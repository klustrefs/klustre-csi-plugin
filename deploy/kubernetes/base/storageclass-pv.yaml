apiVersion: storage.k8s.io/v1
kind: StorageClass
metadata:
  name: klustre-static
provisioner: klustrefs.csi.k8s.io
volumeBindingMode: WaitForFirstConsumer
reclaimPolicy: Retain
mountOptions:
  - flock
  - user_xattr
allowedTopologies:
  - matchLabelExpressions:
      - key: klustre.csi.k8s.io/lustre-client
        values:
          - "true"
---
apiVersion: v1
kind: PersistentVolume
metadata:
  name: klustre-static-pv
spec:
  capacity:
    storage: 96Gi
  accessModes:
    - ReadWriteMany
  persistentVolumeReclaimPolicy: Retain
  storageClassName: klustre-static
  csi:
    driver: klustrefs.csi.k8s.io
    volumeHandle: lustre-volume-example
    volumeAttributes:
      source: YOUR_IP_FOR_LUSTRE@tcp:/testfs
  mountOptions:
    - flock
---
apiVersion: v1
kind: PersistentVolumeClaim
metadata:
  name: klustre-static-pvc
  namespace: klustre-system
spec:
  accessModes:
    - ReadWriteMany
  resources:
    requests:
      storage: 96Gi
  storageClassName: klustre-static
  volumeName: klustre-static-pv
